---
title: "MIT_AD_AE_cluster_annotation"
author: "Anne Pavia"
date: "2025-01-27"
output: html_document
---

# Notes:
I used the best blast hit between Dionne's TAIR marker genes (which includes Li's markers too) and Li's IPAP marker gene from Cro_v3

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# packages 
```{r}
library(tidyverse)
library(Seurat)
library(readxl)
library(RColorBrewer)
library(rcartocolor)
library(viridis)
library(patchwork)
```

# Pull Seurat data
```{r}
stem.combined <- readRDS("/scratch/ac05869/nih/kratom/seurat_analysis/uga_kratom_stem_mitr.v1/MIT_AD_AE_cleaned_integrated_seurat_09jan25.rds")
DefaultAssay(stem.combined) <- "RNA"
stem.combined = JoinLayers(stem.combined)
stem.combined.markers <- FindAllMarkers(stem.combined, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25) %>% group_by(cluster) #min.pct is the minimum fraction that cells cluster needs to be expressing that gene for it to count. logfc.threshhold is the log-fold change in expression between clusters expressing that gene

#define cluster numbers
clusters <- c(0:23)
```

# Pull marker genes and Seurat markers
```{r}
stem_markers <- read_csv("/scratch/ac05869/nih/pop_markers/kratom_stem/MIT_AD_AE_seurat_markers_with_pop_markers_14feb25.csv", col_names = T)
head(stem_markers)
dim(stem_markers) #248

stem_markers2 <- stem_markers %>% 
  dplyr::select(Primary_Gene_Symbol, cell_type, gene_ID, functional_annotation) %>%
  dplyr::filter(is.na(gene_ID) == F)
head(stem_markers2)
```

## Cell type assignment heatmap

# Cell type assignment heatmap
```{r}
DefaultAssay(stem.combined) <- "RNA"

Marker_dotplot <- DotPlot(stem.combined, 
                          features = unique(stem_markers2$gene_ID))

cells <- c(
    "M", "E", "GC", "V", "X", "Ph", "Cam", "Com", "IP", "Idi", "Pro", "G0/G1", "G2", "SAM", "TRI", "Ray"
  )

Marker_dotplot_nice_df <- Marker_dotplot$data %>% 
  rownames_to_column(var = "gene_ID") %>%
  full_join(stem_markers2 %>% 
              distinct(gene_ID, .keep_all = T),
             by = c("features.plot" = "gene_ID")) %>% 
   mutate(cell_type2 = case_when(
    str_detect(cell_type, "meso") ~ "M",
    str_detect(cell_type, "cam") ~ "Cam",
    str_detect(cell_type, "xyl") |
      str_detect(cell_type, "vessel") ~ "X",
    str_detect(cell_type, "phl") |
      str_detect(cell_type, "sieve") ~ "Ph",
    str_detect(cell_type, "com") ~ "Com",
    str_detect(cell_type, "vas") ~ "V",
    str_detect(cell_type, "cortex") ~ "C/Pi",
    str_detect(cell_type, "epi") ~ "E",
    str_detect(cell_type, "guard") ~ "GC",
    str_detect(cell_type, "iridoid") |
      str_detect(cell_type, "IPAP") ~ "IP",
    str_detect(cell_type, "idioblast")  ~ "Idi",
    str_detect(cell_type, "G2")  ~ "G2",
    str_detect(cell_type, "G0/G1")  ~ "G0/G1",
    str_detect(cell_type, "pro") |
    str_detect(cell_type, "Unkn") ~ "Pro",
    str_detect(cell_type, "shoot") ~ "SAM",
    str_detect(cell_type, "trich") ~ "TRI",
    str_detect(cell_type, "ray") ~ "Ray",
  )) %>%
  dplyr::filter(str_detect(cell_type, "shea") == F) %>% 
  mutate(cell_type2 = factor(cell_type2, levels = cells)) %>% 
  mutate(cell_type3 = as.numeric(cell_type2)) %>% 
  mutate(features.plot = reorder(features.plot, cell_type3, decreasing = T)) %>% 
  dplyr::filter(is.na(avg.exp.scaled) == F)%>%
  mutate(tag = paste(features.plot, Primary_Gene_Symbol)) %>%
  mutate(id = factor(id, levels = as.character(clusters)))

head(Marker_dotplot_nice_df)
#View this and compare
```

# Specificity of cell type markers

```{r}
list(cells)
cell <- "E" #filter by cell_type2 to see what markers are cluster specific
Marker_dot <- Marker_dotplot_nice_df %>% 
  filter(str_detect(cell_type2, cell) == T) %>% #filter to see what markers are cluster specific
  ggplot(aes(x = id, y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_point(aes(size = pct.exp, fill = avg.exp.scaled), shape = 21, color = "white") +
  scale_fill_viridis(option = "A", begin = 0, end = 0.9) +
  guides(size = guide_legend(override.aes = list(fill = "grey40"), nrow = 2)) +
  labs(x = "Cluster",
       y = NULL, 
       fill = "Avg. Exp.",
       size = "% Exp.",
       title = "Epidermal") +
  theme_classic() +
  theme(text = element_text(size = 10, color = "black"),
        axis.text = element_text(color = "black"),
        legend.position = "top",
        legend.box = "horizontal",
        legend.key.height = unit(0.7, "lines"))

Marker_dot
ggsave("/scratch/ac05869/nih/pop_markers/kratom_stem/MIT_AD_AE_epidermal_markers.png", width = 10, height = 8)
```


```{r}
list(cells)
cell <- "V" #filter by cell_type2 to see what markers are cluster specific
Marker_dot <- Marker_dotplot_nice_df %>% 
  filter(str_detect(cell_type2, cell) == T) %>% #filter to see what markers are cluster specific
  ggplot(aes(x = id, y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_point(aes(size = pct.exp, fill = avg.exp.scaled), shape = 21, color = "white") +
  scale_fill_viridis(option = "A", begin = 0, end = 0.9) +
  guides(size = guide_legend(override.aes = list(fill = "grey40"), nrow = 2)) +
  labs(x = "Cluster",
       y = NULL, 
       fill = "Avg. Exp.",
       size = "% Exp.",
       title = "Vasculature (Xylem/Phloem)") +
  theme_classic() +
  theme(text = element_text(size = 10, color = "black"),
        axis.text = element_text(color = "black"),
        legend.position = "top",
        legend.box = "horizontal",
        legend.key.height = unit(0.7, "lines"))

Marker_dot
ggsave("/scratch/ac05869/nih/pop_markers/kratom_stem/MIT_AD_AE_VasculatureMixed_markers.png", width = 10, height = 8)
```

```{r}
list(cells)
cell <- "X" #filter by cell_type2 to see what markers are cluster specific
Marker_dot <- Marker_dotplot_nice_df %>% 
  filter(str_detect(cell_type2, cell) == T) %>% #filter to see what markers are cluster specific
  ggplot(aes(x = id, y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_point(aes(size = pct.exp, fill = avg.exp.scaled), shape = 21, color = "white") +
  scale_fill_viridis(option = "A", begin = 0, end = 0.9) +
  guides(size = guide_legend(override.aes = list(fill = "grey40"), nrow = 2)) +
  labs(x = "Cluster",
       y = NULL, 
       fill = "Avg. Exp.",
       size = "% Exp.",
       title = "Xylem") +
  theme_classic() +
  theme(text = element_text(size = 10, color = "black"),
        axis.text = element_text(color = "black"),
        legend.position = "top",
        legend.box = "horizontal",
        legend.key.height = unit(0.7, "lines"))

Marker_dot
ggsave("/scratch/ac05869/nih/pop_markers/kratom_stem/MIT_AD_AE_xylem_markers.png", width = 10, height = 8)
```

```{r}
list(cells)
cell <- "Ph" #filter by cell_type2 to see what markers are cluster specific
Marker_dot <- Marker_dotplot_nice_df %>% 
  filter(str_detect(cell_type2, cell) == T) %>% #filter to see what markers are cluster specific
  ggplot(aes(x = id, y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_point(aes(size = pct.exp, fill = avg.exp.scaled), shape = 21, color = "white") +
  scale_fill_viridis(option = "A", begin = 0, end = 0.9) +
  guides(size = guide_legend(override.aes = list(fill = "grey40"), nrow = 2)) +
  labs(x = "Cluster",
       y = NULL, 
       fill = "Avg. Exp.",
       size = "% Exp.",
       title = "Phloem") +
  theme_classic() +
  theme(text = element_text(size = 10, color = "black"),
        axis.text = element_text(color = "black"),
        legend.position = "top",
        legend.box = "horizontal",
        legend.key.height = unit(0.7, "lines"))

Marker_dot
ggsave("/scratch/ac05869/nih/pop_markers/kratom_stem/MIT_AD_AE_Phloem_markers.png", width = 10, height = 8)
```

```{r}
list(cells)
cell <- "Cam" #filter by cell_type2 to see what markers are cluster specific
Marker_dot <- Marker_dotplot_nice_df %>% 
  filter(str_detect(cell_type2, cell) == T) %>% #filter to see what markers are cluster specific
  ggplot(aes(x = id, y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_point(aes(size = pct.exp, fill = avg.exp.scaled), shape = 21, color = "white") +
  scale_fill_viridis(option = "A", begin = 0, end = 0.9) +
  guides(size = guide_legend(override.aes = list(fill = "grey40"), nrow = 2)) +
  labs(x = "Cluster",
       y = NULL, 
       fill = "Avg. Exp.",
       size = "% Exp.",
       title = "Cambium") +
  theme_classic() +
  theme(text = element_text(size = 10, color = "black"),
        axis.text = element_text(color = "black"),
        legend.position = "top",
        legend.box = "horizontal",
        legend.key.height = unit(0.7, "lines"))

Marker_dot
ggsave("/scratch/ac05869/nih/pop_markers/kratom_stem/MIT_AD_AE_Cambium_markers.png", width = 10, height = 8)
```

```{r}
list(cells)
cell <- "Com" #filter by cell_type2 to see what markers are cluster specific
Marker_dot <- Marker_dotplot_nice_df %>% 
  filter(str_detect(cell_type2, cell) == T) %>% #filter to see what markers are cluster specific
  ggplot(aes(x = id, y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_point(aes(size = pct.exp, fill = avg.exp.scaled), shape = 21, color = "white") +
  scale_fill_viridis(option = "A", begin = 0, end = 0.9) +
  guides(size = guide_legend(override.aes = list(fill = "grey40"), nrow = 2)) +
  labs(x = "Cluster",
       y = NULL, 
       fill = "Avg. Exp.",
       size = "% Exp.",
       title = "Companion Cells") +
  theme_classic() +
  theme(text = element_text(size = 10, color = "black"),
        axis.text = element_text(color = "black"),
        legend.position = "top",
        legend.box = "horizontal",
        legend.key.height = unit(0.7, "lines"))

Marker_dot
ggsave("/scratch/ac05869/nih/pop_markers/kratom_stem/MIT_AD_AE_CompanionCells_markers.png", width = 10, height = 8)
```

```{r}
list(cells)
cell <- "IP" #filter by cell_type2 to see what markers are cluster specific
Marker_dot <- Marker_dotplot_nice_df %>% 
  filter(str_detect(cell_type2, cell) == T) %>% #filter to see what markers are cluster specific
  ggplot(aes(x = id, y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_point(aes(size = pct.exp, fill = avg.exp.scaled), shape = 21, color = "white") +
  scale_fill_viridis(option = "A", begin = 0, end = 0.9) +
  guides(size = guide_legend(override.aes = list(fill = "grey40"), nrow = 2)) +
  labs(x = "Cluster",
       y = NULL, 
       fill = "Avg. Exp.",
       size = "% Exp.",
       title = "IPAP/Iridoid+") +
  theme_classic() +
  theme(text = element_text(size = 10, color = "black"),
        axis.text = element_text(color = "black"),
        legend.position = "top",
        legend.box = "horizontal",
        legend.key.height = unit(0.7, "lines"))

Marker_dot
ggsave("/scratch/ac05869/nih/pop_markers/kratom_stem/MIT_AD_AE_IPAP_markers.png", width = 10, height = 8)
```


```{r}
list(cells)
cell <- "Pro" #filter by cell_type2 to see what markers are cluster specific
Marker_dot <- Marker_dotplot_nice_df %>% 
  filter(str_detect(cell_type2, cell) == T) %>% #filter to see what markers are cluster specific
  ggplot(aes(x = id, y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_point(aes(size = pct.exp, fill = avg.exp.scaled), shape = 21, color = "white") +
  scale_fill_viridis(option = "A", begin = 0, end = 0.9) +
  guides(size = guide_legend(override.aes = list(fill = "grey40"), nrow = 2)) +
  labs(x = "Cluster",
       y = NULL, 
       fill = "Avg. Exp.",
       size = "% Exp.",
       title = "Proliferating") +
  theme_classic() +
  theme(text = element_text(size = 10, color = "black"),
        axis.text = element_text(color = "black"),
        legend.position = "top",
        legend.box = "horizontal",
        legend.key.height = unit(0.7, "lines"))

Marker_dot
ggsave("/scratch/ac05869/nih/pop_markers/kratom_stem/MIT_AD_AE_Proliferating_markers.png", width = 10, height = 8)
```


```{r}
list(cells)
cell <- "SAM" #filter by cell_type2 to see what markers are cluster specific
Marker_dot <- Marker_dotplot_nice_df %>% 
  filter(str_detect(cell_type2, cell) == T) %>% #filter to see what markers are cluster specific
  ggplot(aes(x = id, y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_point(aes(size = pct.exp, fill = avg.exp.scaled), shape = 21, color = "white") +
  scale_fill_viridis(option = "A", begin = 0, end = 0.9) +
  guides(size = guide_legend(override.aes = list(fill = "grey40"), nrow = 2)) +
  labs(x = "Cluster",
       y = NULL, 
       fill = "Avg. Exp.",
       size = "% Exp.",
       title = "Shoot apical meristem") +
  theme_classic() +
  theme(text = element_text(size = 10, color = "black"),
        axis.text = element_text(color = "black"),
        legend.position = "top",
        legend.box = "horizontal",
        legend.key.height = unit(0.7, "lines"))

Marker_dot
ggsave("/scratch/ac05869/nih/pop_markers/kratom_stem/MIT_AD_AE_SAM_markers.png", width = 10, height = 8)
```


```{r}
list(cells)
cell <- "Ray" #filter by cell_type2 to see what markers are cluster specific
Marker_dot <- Marker_dotplot_nice_df %>% 
  filter(str_detect(cell_type2, cell) == T) %>% #filter to see what markers are cluster specific
  ggplot(aes(x = id, y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_point(aes(size = pct.exp, fill = avg.exp.scaled), shape = 21, color = "white") +
  scale_fill_viridis(option = "A", begin = 0, end = 0.9) +
  guides(size = guide_legend(override.aes = list(fill = "grey40"), nrow = 2)) +
  labs(x = "Cluster",
       y = NULL, 
       fill = "Avg. Exp.",
       size = "% Exp.",
       title = "Early Ray Parenchyma") +
  theme_classic() +
  theme(text = element_text(size = 10, color = "black"),
        axis.text = element_text(color = "black"),
        legend.position = "top",
        legend.box = "horizontal",
        legend.key.height = unit(0.7, "lines"))

Marker_dot
ggsave("/scratch/ac05869/nih/pop_markers/kratom_stem/MIT_AD_AE_RayParenchyma_markers.png", width = 10, height = 8)
```









######### Depends on tissue type
## Cell type assignment heatmap
This part needs to be edited depending on the cluster numbers, gene expression, etc.
```{r}
DefaultAssay(stem.combined) <- "RNA"

stem_markers2 <- stem_markers %>% 
  dplyr::select(symbol, cell_type, gene_ID) %>%
  dplyr::filter(str_detect(gene_ID, "Mitsp.v1.06-2G000320") == F) %>% #under-expressed xylem marker
  dplyr::filter(str_detect(gene_ID, "Mitsp.v1.01-2G008870") == F) %>% # under-expressed G0/G1 markers
  dplyr::filter(str_detect(gene_ID, "Mitsp.v1.08-1G000720") == F) %>% # guard cell marker that was coexpressed with phloem/vasculature (APL)
  dplyr::filter(str_detect(gene_ID, "Mitsp.v1.20-2G008400") == F) %>% # under expressed xylem marker
  dplyr::filter(str_detect(gene_ID, "Mitsp.v1.19-1G001940") == F) %>% # under-expressed xylem marker
  dplyr::filter(str_detect(gene_ID, "Mitsp.v1.16-2G012920") == F) %>% # under-expressed phloem marker
  dplyr::filter(is.na(gene_ID) == F)
  
Marker_dotplot <- DotPlot(stem.combined, 
                          features = unique(stem_markers2$gene_ID)) 
head(Marker_dotplot$data)

Marker_dotplot_nice_df <- Marker_dotplot$data %>% 
  mutate(gene_ID = row.names(.)) %>% 
  mutate(gene_ID = str_sub(gene_ID, end = 15)) %>% 
  full_join(stem_markers2 %>% 
              distinct(gene_ID, .keep_all = T),
             by = c("features.plot" = "gene_ID")) %>% 
   mutate(cell_type2 = case_when(
    str_detect(cell_type, "meso") ~ "M",
    str_detect(cell_type, "cam|x|phl|com|vas|trach") ~ "V",
    str_detect(cell_type, "epi") ~ "E",
    str_detect(cell_type, "guard") ~ "GC",
    str_detect(cell_type, "IPAP") ~ "IP",
    str_detect(cell_type, "idioblast")  ~ "I",
    str_detect(cell_type, "G0|G1|G2|prolif")  ~ "Pro",
    str_detect(cell_type, "shoot") ~ "SAM",
    str_detect(cell_type, "trich") ~ "TRI"
  )) %>% 
  dplyr::filter(str_detect(cell_type, "shea") == F) %>% 
  mutate(cell_type2 = factor(cell_type2, levels = c(
    "M", "E", "GC", "V", "IP", "I", "Pro", "SAM", "TRI"
  ))) %>% 
  mutate(cell_type3 = as.numeric(cell_type2)) %>% 
  mutate(features.plot = reorder(features.plot, cell_type3, decreasing = T)) %>% 
  dplyr::filter(is.na(avg.exp.scaled) == F)%>%
  mutate(tag = paste(features.plot, cell_type2)) %>%
  mutate(id = factor(id, levels = c("1", "2", "4", "5", "7", "9", "19", "23",
                                    "20",
                                    "6", "22", "10", "15", "17", "0", "3", "8",
                                    "12", "14", "13", "18", 
                                    "11", "16", "21"
                                    )))

dim(Marker_dotplot_nice_df) #552
head(Marker_dotplot_nice_df)
```

* Mesophyll: "1", "2", "4", "5", "7", "9", "19", "23",
* Epi: "20",
* Guard: 
* Vasculature: "0", "3", "6", "22", "8", "10", "15", "17",
* SAM: "12", "14", "13", "18", 
* Un: "11", "16", "21" 

```{r}
Marker_dot <- Marker_dotplot_nice_df %>% 
  ggplot(aes(x = id, y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_point(aes(size = pct.exp, fill = avg.exp.scaled), shape = 21, color = "white") +
  scale_fill_viridis(option = "A", begin = 0, end = 0.9) +
  guides(size = guide_legend(override.aes = list(fill = "grey40"), nrow = 2)) +
  labs(x = "Cluster",
       y = NULL, 
       fill = "Avg. Exp.",
       size = "% Exp.") +
  theme_classic() +
  theme(text = element_text(size = 14, color = "black"),
        axis.text = element_text(color = "black"),
        legend.position = "top",
        legend.box = "horizontal",
        legend.key.height = unit(0.7, "lines"))

Marker_dot
ggsave("/scratch/ac05869/nih/kratom/MIT_AD_AE_clusters_with_Dionne_markers_05feb25.png", width = 10, height = 8)
```

#Merge seurat cluster top marker file with stem_markers to identify top markers for each cluster
```{r}
cluster_markers <- read_delim("/scratch/ac05869/nih/kratom_pathway/MIT_AD_AE_clean_integrated_all_markers_minpct0.25_minlfc0.25_with_info_30jan25.txt", delim = "\t", col_names = T) %>% rename("gene_ID" = "ID")
cluster_markers$gene_ID <- gsub(pattern = "_", replacement = "-", cluster_markers$gene_ID)
head(cluster_markers)
head(stem_markers)

cluster_markers2 <- inner_join(cluster_markers, stem_markers, by = "gene_ID") %>% 
  group_by(cluster) %>%
  select(1, 11, 2, 13, 12, 8, 9, 10, 14, 17, 21)
head(cluster_markers2)

#remove commas from Reference column in order to write csv file
cluster_markers2 <- cluster_markers2 %>%
  mutate(Reference = str_replace(Reference, ",", " ")) %>%
           write_csv(file = "~/nih/marker_genes/merged_Dionne_markers_MIT_AD_AE_all_markers_minpct0.25_minlfc0.25_05feb25.csv", quote = "none")
head(cluster_markers2)
```

* Mesophyll: "1", "2", "4", "5", "7", "9", "19", "23",
* Epi: "20",
* Guard: 
* Vasculature: "0", "3", "6", "22", "8", "10", "15", "17",
* SAM: "12", "14", "13", "18", 
* Un: "11", "16", "21" 

```{r}
stem_cell_type_assignment <- data.frame(
  cluster = c(0:23)
) %>% 
  mutate(cell_type = case_when(
    cluster == 1 |
      cluster == 2 |
      cluster == 4 |
      cluster == 5 |
      cluster == 7 |
      cluster == 9 | 
      cluster == 19 |
      cluster == 23 ~ "Mesophyll",
    cluster == 20 ~ "Epidermis",
    cluster == 0 |
      cluster == 3 |
      cluster == 6 |
      cluster == 22 |
      cluster == 8 |
      cluster == 10 |
      cluster == 15 |
      cluster == 17  ~ "Vasculature",
    cluster == 12 |
      cluster == 14 |
      cluster == 13 |
      cluster == 18 ~ "SAM",
    cluster == 11 |
      cluster == 16 |
      cluster ==21 ~ "Unassigned"
  )) %>% 
  mutate(cell_type = factor(cell_type, 
                            levels = c(
                              "Mesophyll", "Epidermis",
                              "Vasculature", 
                              "SAM",
                              "Unassigned"
                            ))) %>% 
  mutate(cluster = factor(cluster, levels = c(
     "1", "2", "4", "5", "7", "9", "19", "23",
     "20",
     "0", "3", "6", "22", "8", "10", "15", "17",
     "12", "14", "13", "18",
     "11", "16", "21" 
    )))
```


```{r}
stem_cell_type_strip <- stem_cell_type_assignment %>% 
  ggplot(aes(x = cluster, y = "" )) +
  geom_tile(aes(fill = cell_type)) +
  scale_fill_manual(values = c(brewer.pal(6, "Accent"), "grey80")) +
  guides(fill = guide_legend(nrow = 3)) +
  labs(fill = "Cell type") +
  theme_void() +
  theme(
    legend.position = "bottom" ,
    text = element_text(size = 14)
  )

stem_cell_type_strip

stem_cell_type_mkr_text <- Marker_dotplot_nice_df %>% 
  dplyr::filter(id == 0) %>% 
  ggplot(aes(x = "", y = reorder(tag, cell_type3, decreasing = TRUE))) +
  geom_text(aes(label = unique(symbol), fontface = "italic")) +
  theme_void()

blank <- data.frame(
  x = 0,
  y = 0
) %>% 
  ggplot(aes(x, y)) +
  theme_void()

Marker_dot_strip <- wrap_plots(Marker_dot, stem_cell_type_mkr_text,
          stem_cell_type_strip, blank,
          heights = c(1, 0.03), 
          widths = c(1, 0.2), nrow = 2, ncol = 2)

Marker_dot_strip

ggsave("/scratch/ac05869/nih/kratom/MIT_AD_AE_cell_type_assignment_plot.svg", height = 8, width = 7.5, bg = "white")
ggsave("/scratch/ac05869/nih/kratom/MIT_AD_AE_cell_type_assignment_plot.png", height = 6, width = 7.5, bg = "white")
```


